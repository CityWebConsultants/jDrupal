<!DOCTYPE html>
<html>

  <head>
    <title>jDrupal</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <script src="src/includes/module.inc.js"></script>
    <script src="src/comment.js"></script>
    <script src="src/drupal.js"></script>
    <script src="src/entity.js"></script>
    <script src="src/node.js"></script>
    <script src="src/services/services.comment.js"></script>
    <script src="src/services/services.entity.js"></script>
    <script src="src/services/services.js"></script>
    <script src="src/services/services.node.js"></script>
    <script src="src/services/services.system.js"></script>
    <script src="src/services/services.taxonomy_term.js"></script>
    <script src="src/services/services.taxonomy_vocabulary.js"></script>
    <script src="src/services/services.user.js"></script>
    <script src="src/taxonomy_term.js"></script>
    <script src="src/taxonomy_vocabulary.js"></script>
    <script src="src/user.js"></script>
    
  </head>

  <body onload="start_my_app()">
  
    <h1>jDrupal</h1>
    <form id="user_login_form" style="display: none;">
      <label for="name">Username</label>
      <input name="name" id="edit-name" type="text" value="" />
      <label for="name">Password</label>
      <input name="pass" id="edit-pass" type="password" value=""  />
      <input type="button" value="Login" onclick="user_login_click()"/>
    </form>
    
    <script type="text/javascript">
    
      // Set the site path (without the trailing slash).
      Drupal.settings.site_path = ""; // http://www.example.com
      
      // Turn on debugging.
      Drupal.settings.debug = true;
    
      function start_my_app() {
        try {
        
          // Connect to Drupal... if the user is anonymous show them the login
          // form, otherwise say hello to them.
          jdrupal_connect({
            success: function(result) {
                if (Drupal.user.uid[0]['value'] != '0') {
                  alert('Hello ' + Drupal.user.name[0]['value']);
                }
                else {
                  document.getElementById('user_login_form').style.display = 'inline';
                }
            }
          });
        
        }
        catch (error) { console.log('start_my_app - ' + error); }
      }
      
      // Handle the login button click.
      function user_login_click() {
        var name = document.getElementById('edit-name').value;
        var pass = document.getElementById('edit-pass').value;
        if (empty(name)) { alert('Enter a user name!'); return; }
        if (empty(pass)) { alert('Enter a password!'); return; }
        user_login(name, pass, {
            success: function(result) {
              alert('Hello ' + Drupal.user.name[0]['value']);
            },
            error: function(xhr, status, result) {
              alert(result.message);
            }
        });
      }
    
    </script>
    
  </body>
</html>
