var Drupal=Drupal||drupal_init();Drupal.sessid=null;Drupal.user=drupal_user_defaults();function dpm(b){b&&("object"===typeof b?console.log(JSON.stringify(b)):console.log(b))}function drupal_init(){return{settings:{site_path:"",base_path:"/",language_default:"und"}}}function drupal_user_defaults(){return{uid:"0",roles:{1:"anonymous user"}}}function function_exists(b){try{return"function"==eval("typeof "+b)}catch(a){alert("function_exists - "+a)}}
function http_status_code_title(b){try{var a="";switch(b){case 200:a="OK";break;case 401:a="Unauthorized";break;case 404:a="Not Found";break;case 406:a="Not Acceptable"}return a}catch(c){console.log("http_status_code_title - "+c)}}function in_array(b,a){return-1<a.indexOf(b)}function language_default(){try{return Drupal.settings.language_default}catch(b){console.log("language_default - "+b)}}function comment_load(b,a){try{entity_load("comment",b,a)}catch(c){console.log("comment_load - "+c)}}
function comment_save(b,a){try{entity_save("comment",null,b,a)}catch(c){console.log("comment_save - "+c)}}
function entity_assemble_data(b,a,c,d){try{b="";for(var e in c)if(c.hasOwnProperty(e))if("object"===typeof c[e])for(var f in c[e]){if(c[e].hasOwnProperty(f))for(var g in c[e][f])if(c[e][f].hasOwnProperty(g))for(var h in c[e][f][g])c[e][f][g].hasOwnProperty(h)&&(b+=e+"["+f+"]["+g+"]["+h+"]="+encodeURIComponent(c[e][f][g][h])+"&")}else b+=e+"="+encodeURIComponent(c[e])+"&";""!=b&&(b=b.substring(0,b.length-1));return b}catch(k){console.log("entity_assemble_data - "+k)}}
function entity_delete(b,a,c){try{var d=b+"_delete";if(function_exists(d))(0,window[d])(a,c);else console.log("WARNING: entity_delete - unsupported type: "+b)}catch(e){console.log("entity_delete - "+e)}}function entity_load(b,a,c){try{var d=b+"_retrieve";if(function_exists(d))(0,window[d])(a,c);else console.log("WARNING: entity_load - unsupported type: "+b)}catch(e){console.log("entity_load - "+e)}}
function entity_save(b,a,c,d){try{var e;switch(b){case "comment":e=c.cid?"comment_update":"comment_create";break;case "node":c.language||(c.language=language_default());e=c.nid?"node_update":"node_create";break;case "user":e=c.uid?"user_update":"user_create";break;case "taxonomy_term":e=c.tid?"taxonomy_term_update":"taxonomy_term_create";break;case "taxonomy_vocabulary":e=c.vid?"taxonomy_vocabulary_update":"taxonomy_vocabulary_create"}if(e&&function_exists(e))(0,window[e])(c,d);else console.log("WARNING: entity_save - unsupported type: "+
b)}catch(f){console.log("entity_save - "+f)}}function node_load(b,a){try{entity_load("node",b,a)}catch(c){console.log("node_load - "+c)}}function node_save(b,a){try{entity_save("node",b.type,b,a)}catch(c){console.log("node_save - "+c)}}function taxonomy_term_load(b,a){try{entity_load("taxonomy_term",b,a)}catch(c){console.log("taxonomy_term_load - "+c)}}function taxonomy_term_save(b,a){try{entity_save("taxonomy_term",null,b,a)}catch(c){console.log("taxonomy_term_save - "+c)}}
function taxonomy_vocabulary_load(b,a){try{entity_load("taxonomy_vocabulary",b,a)}catch(c){console.log("taxonomy_vocabulary_load - "+c)}}function taxonomy_vocabulary_save(b,a){try{entity_save("taxonomy_vocabulary",null,b,a)}catch(c){console.log("taxonomy_vocabulary_save - "+c)}}function user_load(b,a){try{entity_load("user",b,a)}catch(c){console.log("user_load - "+c)}}
function user_password(b){try{var a=10;b&&(a=b);b="";for(var c=0;c<a;c++)b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz23456789".charAt(Math.floor(60*Math.random()));return b}catch(d){console.log("user_password - "+d)}}function user_save(b,a){try{entity_save("user",null,b,a)}catch(c){console.log("user_save - "+c)}}Drupal.services={};
Drupal.services.call=function(b){try{if(b.debug=!1,services_ready()){var a=new XMLHttpRequest,c=Drupal.settings.site_path+Drupal.settings.base_path+"?q="+Drupal.settings.endpoint+"/"+b.path,d=b.method.toUpperCase();console.log(d+": "+c);a.onload=function(e){if(4==a.readyState)if(e=a.status+" - "+http_status_code_title(a.status),200==a.status)b.success(JSON.parse(a.responseText));else{if(dpm(a),console.log(d+": "+c+" - "+e),a.responseText?console.log(a.responseText):dpm(a),"undefined"!==typeof b.error){var g=
a.responseText;g||(g=e);b.error(a,a.status,g)}}else console.log("request.readyState = "+a.readyState)};Drupal.services.csrf_token(d,c,a,{debug:b.debug,path:b.path,success:function(e){a.open(d,c,!0);"POST"==d?a.setRequestHeader("Content-type","application/x-www-form-urlencoded"):"PUT"==d&&a.setRequestHeader("Content-type","application/json");e&&a.setRequestHeader("X-CSRF-Token",e);"undefined"!==typeof b.data?("user/login.json"!=b.path&&("object"===typeof b.data?console.log(JSON.stringify(b.data)):
console.log(b.data)),a.send(b.data)):a.send(null)}})}else b.error(null,null,"Set the site_path and endpoint on Drupal.settings!")}catch(e){console.log("Drupal.services.call - error - "+e)}};
Drupal.services.csrf_token=function(b,a,c,d){try{var e=!1;if(in_array(b,["GET","HEAD","OPTIONS","TRACE"]))d.debug&&dpm("Method does not need token!"),d.success(!1);else if(0==Drupal.user.uid&&"system/connect.json"!=d.path)d.debug&&dpm("Anonymous user does not need token for this call!"),d.success(!1);else if((e=window.localStorage.getItem("sessid"))&&d.debug&&dpm("Loaded token from local storage!"),!e&&Drupal.sessid&&(e=Drupal.sessid,d.debug&&dpm("Loaded token from Drupal JSON object!")),e)d.debug&&
dpm("Previous token available, using it!"),Drupal.sessid=e,d.success(e);else{var f=new XMLHttpRequest,g=Drupal.settings.site_path+Drupal.settings.base_path+"?q=services/session/token";f.onload=function(a){4==f.readyState?(a=f.status+" - "+http_status_code_title(f.status),200!=f.status?(console.log(g+" - "+a),console.log(f.responseText)):(d.debug&&dpm("Grabbed token from Drupal site!"),e=f.responseText,window.localStorage.setItem("sessid",e),Drupal.sessid=e,d.success(e))):console.log("token_request.readyState = "+
f.readyState)};f.open("GET",g,!0);f.send(null)}}catch(h){console.log("Drupal.services.call - error - "+h)}};function services_ready(){var b=!0;""==Drupal.settings.site_path&&(b=!1,console.log("jDrupal's Drupal.settings.site_path is not set!"));""==Drupal.settings.endpoint&&(b=!1,console.log("jDrupal's Drupal.settings.endpoint is not set!"));return b}
function comment_create(b,a){try{a.method="POST",a.path="comment.json",entity_create("comment",null,b,a)}catch(c){console.log("comment_create - "+c)}}function comment_retrieve(b,a){try{a.method="GET",a.path="comment/"+b+".json",entity_retrieve("comment",b,a)}catch(c){console.log("comment_retrieve - "+c)}}function comment_update(b,a){try{a.method="PUT",a.path="comment/"+b.cid+".json",entity_update("comment",null,b,a)}catch(c){console.log("comment_update - "+c)}}
function comment_delete(b,a){try{Drupal.services.call({method:"DELETE",path:"comment/"+b+".json",success:function(b){a.success&&a.success(b)},error:function(b,c,f){a.error&&a.error(b,c,f)}})}catch(c){console.log("comment_delete - "+c)}}function comment_index(b,a){try{entity_index("comment",b,a)}catch(c){console.log("comment_index - "+c)}}
function entity_create(b,a,c,d){try{Drupal.services.call({method:d.method,path:d.path,data:entity_assemble_data(b,a,c,d),success:function(a){d.success&&d.success(a)},error:function(a,b,c){d.error&&d.error(a,b,c)}})}catch(e){console.log("entity_create - "+e)}}function entity_retrieve(b,a,c){try{Drupal.services.call({method:c.method,path:c.path,success:function(a){c.success&&c.success(a)},error:function(a,b,d){c.error&&c.error(a,b,d)}})}catch(d){console.log("entity_retrieve - "+d)}}
function entity_update(b,a,c,d){try{a={},"taxonomy_term"==b||"taxonomy_vocabulary"==b||"user"==b?a=c:a[b]=c,Drupal.services.call({method:d.method,path:d.path,data:JSON.stringify(a),success:function(a){d.success&&d.success(a)},error:function(a,b,c){d.error&&d.error(a,b,c)}})}catch(e){console.log("entity_update - "+e)}}
function entity_index(b,a,c){try{var d;"object"===typeof a?d=entity_index_build_query_string(a):"string"===typeof a&&(d=a);Drupal.services.call({method:"GET",path:b+".json"+(d?"&"+d:""),success:function(a){c.success&&c.success(a)},error:function(a,b,d){c.error&&c.error(a,b,d)}})}catch(e){console.log("entity_index - "+e)}}
function entity_index_build_query_string(b){try{var a="";if(!b)return a;if(b.fields){for(var c="",d=0;d<b.fields.length;d++)c+=encodeURIComponent(b.fields[d])+",";""!=c&&(c="fields="+c.substring(0,c.length-1),a+=c+"&")}if(b.parameters){var c="",e;for(e in b.parameters)if(b.parameters.hasOwnProperty(e))var f=encodeURIComponent(e),g=encodeURIComponent(b.parameters[e]),c=c+("parameters["+f+"]="+g+"&");""!=c&&(c=c.substring(0,c.length-1),a+=c+"&")}"undefined"!==typeof b.page&&(a+="page="+encodeURIComponent(b.page)+
"&");"undefined"!==typeof b.page_size&&(a+="page_size="+encodeURIComponent(b.page_size)+"&");return a.substring(0,a.length-1)}catch(h){console.log("entity_index_build_query_string - "+h)}}function node_create(b,a){try{a.method="POST",a.path="node.json",entity_create("node",b.type,b,a)}catch(c){console.log("node_create - "+c)}}function node_retrieve(b,a){try{a.method="GET",a.path="node/"+b+".json",entity_retrieve("node",b,a)}catch(c){console.log("node_retrieve - "+c)}}
function node_update(b,a){try{a.method="PUT",a.path="node/"+b.nid+".json",entity_update("node",b.type,b,a)}catch(c){console.log("node_update - "+c)}}function node_delete(b,a){try{Drupal.services.call({method:"DELETE",path:"node/"+b+".json",success:function(b){a.success&&a.success(b)},error:function(b,c,f){a.error&&a.error(b,c,f)}})}catch(c){console.log("node_delete - "+c)}}function node_index(b,a){try{entity_index("node",b,a)}catch(c){console.log("node_index - "+c)}}
function system_connect(b){try{Drupal.services.call({method:"POST",path:"system/connect.json",success:function(a){Drupal.user=a.user;b.success&&b.success(a)},error:function(a,d,e){b.error&&b.error(a,d,e)}})}catch(a){console.log("system_connect - "+a)}}function taxonomy_term_create(b,a){try{a.method="POST",a.path="taxonomy_term.json",entity_create("taxonomy_term",null,b,a)}catch(c){console.log("taxonomy_term_create - "+c)}}
function taxonomy_term_retrieve(b,a){try{a.method="GET",a.path="taxonomy_term/"+b+".json",entity_retrieve("taxonomy_term",b,a)}catch(c){console.log("taxonomy_term_retrieve - "+c)}}function taxonomy_term_update(b,a){try{a.method="PUT",a.path="taxonomy_term/"+b.tid+".json",entity_update("taxonomy_term",null,b,a)}catch(c){console.log("taxonomy_term_update - "+c)}}
function taxonomy_term_delete(b,a){try{Drupal.services.call({method:"DELETE",path:"taxonomy_term/"+b+".json",success:function(b){a.success&&a.success(b)},error:function(b,c,f){a.error&&a.error(b,c,f)}})}catch(c){console.log("taxonomy_term_delete - "+c)}}function taxonomy_term_index(b,a){try{entity_index("taxonomy_term",b,a)}catch(c){console.log("taxonomy_term_index - "+c)}}
function taxonomy_vocabulary_create(b,a){try{a.method="POST",a.path="taxonomy_vocabulary.json",!b.machine_name&&b.name&&(b.machine_name=b.name.toLowerCase().replace(" ","_")),entity_create("taxonomy_vocabulary",null,b,a)}catch(c){console.log("taxonomy_vocabulary_create - "+c)}}function taxonomy_vocabulary_retrieve(b,a){try{a.method="GET",a.path="taxonomy_vocabulary/"+b+".json",entity_retrieve("taxonomy_vocabulary",b,a)}catch(c){console.log("taxonomy_vocabulary_retrieve - "+c)}}
function taxonomy_vocabulary_update(b,a){try{b.machine_name&&""!=b.machine_name?(a.method="PUT",a.path="taxonomy_vocabulary/"+b.vid+".json",entity_update("taxonomy_vocabulary",null,b,a)):(console.log("taxonomy_vocabulary_update - missing machine_name"),a.error&&a.error(null,406,"taxonomy_vocabulary_update - missing machine_name"))}catch(c){console.log("taxonomy_vocabulary_update - "+c)}}
function taxonomy_vocabulary_delete(b,a){try{Drupal.services.call({method:"DELETE",path:"taxonomy_vocabulary/"+b+".json",success:function(b){a.success&&a.success(b)},error:function(b,c,f){a.error&&a.error(b,c,f)}})}catch(c){console.log("taxonomy_vocabulary_delete - "+c)}}function taxonomy_vocabulary_index(b,a){try{entity_index("taxonomy_vocabulary",b,a)}catch(c){console.log("taxonomy_vocabulary_index - "+c)}}
function user_create(b,a){try{a.method="POST",a.path="user.json",entity_create("user",null,b,a)}catch(c){console.log("user_create - "+c)}}function user_retrieve(b,a){try{a.method="GET",a.path="user/"+b+".json",entity_retrieve("user",b,a)}catch(c){console.log("user_retrieve - "+c)}}
function user_register(b,a){try{Drupal.services.call({method:"POST",path:"user/register.json",data:entity_assemble_data("user",null,b,a),success:function(b){a.success&&a.success(b)},error:function(b,c,f){406==c&&console.log("user_register - Already logged in, cannot register user!");a.error&&a.error(b,c,f)}})}catch(c){console.log("user_retrieve - "+c)}}
function user_update(b,a){try{a.method="PUT",a.path="user/"+b.uid+".json",entity_update("user",null,b,a)}catch(c){console.log("user_update - "+c)}}function user_delete(b,a){try{Drupal.services.call({method:"DELETE",path:"user/"+b+".json",success:function(b){a.success&&a.success(b)},error:function(b,c,f){a.error&&a.error(b,c,f)}})}catch(c){console.log("user_delete - "+c)}}function user_index(b,a){try{entity_index("user",b,a)}catch(c){console.log("user_index - "+c)}}
function user_login(b,a,c){try{Drupal.services.call({method:"POST",path:"user/login.json",data:"username="+encodeURIComponent(b)+"&password="+encodeURIComponent(a),success:function(b){Drupal.user=b.user;var a=new XMLHttpRequest,d=Drupal.settings.site_path+Drupal.settings.base_path+"?q=services/session/token";a.onload=function(h){4==a.readyState?(h=a.status+" - "+http_status_code_title(a.status),200!=a.status?(console.log("user_login - "+d+" - "+h),console.log(a.responseText)):(token=a.responseText,
window.localStorage.setItem("sessid",token),Drupal.sessid=token,c.success&&c.success(b))):console.log("user_login token_request.readyState = "+a.readyState)};a.open("GET",d,!0);a.send(null)},error:function(a,b,d){c.error&&c.error(a,b,d)}})}catch(d){console.log("user_login - "+d)}}
function user_logout(b){try{Drupal.services.call({method:"POST",path:"user/logout.json",success:function(a){Drupal.user=drupal_user_defaults();Drupal.sessid=null;window.localStorage.removeItem("sessid");b.success&&b.success(a)},error:function(a,d,e){b.error&&b.error(a,d,e)}})}catch(a){console.log("user_login - "+a)}};
